<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Director DashBoard</title>
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <style>
      * {
        padding: 0px;
        margin: 0px;
      }

      body {
        background: #e2e7eb;
      }

      .main-panel {
        display: grid;
        grid-template-columns: 250px 1fr;
        grid-template-rows: 60px 1fr;
        grid-template-areas:
          'sidebar header'
          'sidebar Right-panel';
        height: 100vh;
        gap: 3px;
      }

      .sidebar {
        grid-area: sidebar;
        background-color: white;
        color: black;
      }

      /* User-profile design*/
      .user-profile {
        margin: 20px;
        padding: 20px;
        border-radius: 20px;
        padding: 20px;
      }

      img {
        width: 180px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
      }

      .Director-Options {
        margin-top: 20px;
      }

      ul {
        list-style: none;
        margin-top: 50px;
      }

      li {
        padding: 15px;
        font-size: large;
        border-bottom: 1px solid rgba(63, 61, 61, 0.2);
        border-radius: 10px;
        cursor: pointer;
        margin: 10px 0px;
        margin: 10px;
      }

      .Director-Options li a {
        display: flex;
        gap: 14px;
        align-items: center;
      }
      li:hover {
        background-color: rgb(185, 184, 182);
      }
      .Director-Options li.active {
        background-color: rgb(227, 226, 223);
      }

      .sidebar a {
        text-decoration: none;
        color: black;
      }

      header {
        grid-area: header;
        background: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 25px 20px;
        border-bottom: 1px solid #ddd;
      }
      #search {
        border: 2.5px solid rgb(128, 209, 143);
        padding: 5px;
        border-radius: 5px;
        width: 25%;
      }

      .Right-panel {
        grid-area: Right-panel;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
        border-radius: 10px;
        margin: 5%;
      }

      .stats {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 20px;
      }
      .Panel-1 {
        background-color: white;
        border-radius: 5px;
        padding: 25px;
        box-shadow: black;
        margin: 20px;
        margin-bottom: 300px;
      }

      .Panel-1 h1 {
        text-align: right;
        font-size: 50px;
        color: green;
        font-weight: bolder;
        text-align: right;
      }

      .user-header {
        display: flex;
        border-radius: 25px;
        padding: 8px 14px;
        gap: 20px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        align-items: center;
      }

      .Avatar {
        background-color: #1e1e2f;
        color: white;
        padding: 5px;
        border-radius: 20px;
        font-size: larger;
      }

      .user-info {
        display: block;
        align-items: center;
      }

      .user-name {
        font: 30px;
      }

      .user-role {
        font-size: 12px;
        color: gray;
      }

      .Panel-1 .parameters {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        margin: 0px;
        gap: 5px;
      }

      #cash {
        font-size: 300%;
        text-align: right;
        color: green;
      }

      #cash-title {
        font-size: 150%;
      }

      #ugx_cash {
        font-size: 200%;
        margin-top: 20px;
        text-align: right;
        color: green;
      }

      #credit {
        font-size: 300%;
        text-align: right;
        color: green;
      }

      #credit-title {
        font-size: 150%;
      }

      #ugx_credit {
        font-size: 200%;
        margin-top: 20px;
        text-align: right;
        color: green;
      }

      #procurement {
        font-size: 300%;
      }
      #procurement-title {
        font-size: 150%;
      }
      #ugx_procurement {
        font-size: 200%;
        margin-top: 20px;
        text-align: right;
        color: green;
      }

      #user {
        font-size: 300%;
      }

      #number {
        font-size: 150%;
        margin-top: 30px;
      }

      .last-updated {
        margin-top: 20px;
        color: #1e1e2f;
      }
    </style>
  </head>
  <body>
    <div class="main-panel">
      <!--Left side panel-->
      <div class="sidebar">
        <div class="user-profile">
          <img src="Karibu-logo.png" />
        </div>

        <div class="Director-Options">
          <ul>
            <li class="active">
              <a href="Karibu_Director_DashBoard.html">
                <div class="material-icons">dashboard</div>
                Main DashBoard</a
              >
            </li>
            <li>
              <a href="Karibu_Director_Sales_Report.html"
                ><div class="material-icons">bar_chart</div>
                Sales Report</a
              >
            </li>
            <li>
              <a href="Karibu_Director_Sales_Summaries.html">
                <div class="material-icons">summarize</div>
                Sales Summaries</a
              >
            </li>
            <li>
              <a href="Karibu_Director_AggregatedSummaries.html">
                <div class="material-icons">point_of_sale</div>
                Aggregated Sales</a
              >
            </li>

            <li>
              <a href="Karibu_Employee.html">
                <div class="material-icons">group</div>
                Employees</a
              >
            </li>

            <li>
              <a href="Karibu_DashBoard.html"
                ><div class="material-icons">logout</div>
                Log Out</a
              >
            </li>
          </ul>
        </div>
      </div>

      <header>
        <h2>Director Dashboard</h2>
        <input type="text" id="search" placeholder="search items" />
        <div class="user-header">
          <div class="Avatar">SB</div>
          <div class="user-info">
            <div class="user-name">
              <h5>Simon</h5>
            </div>
            <div class="user-role">Director</div>
          </div>
        </div>
      </header>

      <!--Right side panel-->
      <div class="Right-panel">
        <div class="stats">
          <div class="Panel-1">
            <div class="parameters">
              <!--Display area for total cash sales-->
              <h2 id="cash-title">Cash Sales.</h2>
              <h1 id="cash"></h1>

              <!--Display area for total ugx for cash sales-->
              <h2 id="number">UGX.</h2>
              <h2 id="ugx_cash"></h2>
            </div>
            <h5 class="last-updated">last-updated</h5>
          </div>

          <!--Credit manager panel 0779761960-->
          <div class="Panel-1">
            <div class="parameters">
              <h3 id="credit-title">Credit Sales:</h3>
              <h1 id="credit"></h1>

              <!--Display area for total ugx for cash sales-->
              <h2 id="number">UGX.</h2>
              <h2 id="ugx_credit"></h2>
            </div>
            <h5 class="last-updated">last-updated</h5>
          </div>

          <!--Procurement manager panel 0779761960-->
          <div class="Panel-1">
            <div class="parameters">
              <h3 id="procurement-title">Procurements:</h3>
              <h1 id="procurement"></h1>

              <h2 id="number">UGX.</h2>
              <h2 id="ugx_procurement"></h2>
            </div>
            <h5 class="last-updated">last-updated</h5>
          </div>
        </div>
      </div>
    </div>

    <script>
      let display = document.querySelector('#cash');
      let ugxCash = document.querySelector('#ugx_cash');

      let credit_display = document.querySelector('#credit');
      let ugxCredit = document.querySelector('#ugx_credit');

      let procurement_display = document.querySelector('#procurement');
      let ugxProcurement = document.querySelector('#ugx_procurement');

      const API_URL = 'http://localhost:3000';

      //Total cash sales counter
      async function cash_sale_counter() {
        let response = await fetch(`${API_URL}/api/cashsales`);
        let result = await response.json();
        let cash_counter = 0;

        for (let k = 0; k < result.data.length; k++) {
          if (result.data[k].Amount_paid) {
            cash_counter += result.data[k].Amount_paid;
          }
        }
        let totalsales = result.data.length;
        display.textContent = totalsales;
        ugxCash.textContent = cash_counter.toLocaleString();
        console.log(totalsales);
      }
      cash_sale_counter();

      //Total credit sales counter
      async function credit_counter() {
        let credit_getter = await fetch(`${API_URL}/api/creditsales`);
        let result = await credit_getter.json();
        let credit_count = 0;

        for (let k = 0; k < result.data.length; k++) {
          if (result.data[k].Amount_Due) {
            credit_count += result.data[k].Amount_Due;
          }
        }

        let totalcredit = result.data.length;
        credit_display.textContent = totalcredit;
        ugxCredit.textContent = credit_count.toLocaleString();
        console.log(totalcredit);
      }
      credit_counter();

      //Procurement counter
      async function procurement_counter() {
        let procurement_getter = await fetch(`${API_URL}/api/procurement`);
        let result = await procurement_getter.json();
        let procurement_count = 0;

        for (let j = 0; j < result.data.length; j++) {
          if (result.data[j].Produce_Cost) {
            procurement_count += result.data[j].Produce_Cost;
          }
        }

        let totalprocurement = result.data.length;
        procurement_display.textContent = totalprocurement;
        ugxProcurement.textContent = procurement_count.toLocaleString();
      }
      procurement_counter();
    </script>
  </body>
</html>
